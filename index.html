<!doctype html>
<!-- =========================================================
  NFC HUB — Root Card Loader (Path-based clients)
  =========================================================

  Loads client JSON from:
    /data/clients/{slug}.json

  Example URLs:
    /john
    /sam
    /test

========================================================= -->
<html lang="en">
<head>

<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<title>NFC Card</title>

<link rel="stylesheet" href="/base.css"/>

<!-- Theme stylesheet (overridden dynamically) -->
<link id="themeStylesheet" rel="stylesheet" href="/themes/theme-01-neon-dark.css"/>

<link rel="icon" href="/logo.jpg"/>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

</head>

<body>

<main class="wrap">

<section class="card">

<header class="hero">

<a class="logo-link" id="logoLink" href="#" target="_blank">

<img class="logo" id="logoImg" src="/logo.jpg" alt="Logo"/>

</a>

<div class="titleblock">

<h1 class="brand" id="brand">Loading...</h1>

<p class="tagline" id="tagline"></p>

</div>

</header>

<!-- Links -->
<nav class="links" id="linksNav">

<a class="btn" id="btnWebsite" href="#" target="_blank" rel="noopener">Website</a>
<a class="btn" id="btnFacebook" href="#" target="_blank" rel="noopener">Facebook</a>
<a class="btn" id="btnInstagram" href="#" target="_blank" rel="noopener">Instagram</a>
<a class="btn" id="btnTikTok" href="#" target="_blank" rel="noopener">TikTok</a>
<a class="btn" id="btnLinkedIn" href="#" target="_blank" rel="noopener">LinkedIn</a>
  
<a class="btn" id="btnPayPal" href="#" target="_blank" rel="noopener">PayPal</a>
<a class="btn" id="btnCashApp" href="#" target="_blank" rel="noopener">Cash App</a>
<a class="btn" id="btnVenmo" href="#" target="_blank" rel="noopener">Venmo</a>

<a class="btn vcard" id="btnVcard" href="#" download>Save Contact</a>

</nav>

<!-- About -->
<section class="section" id="aboutSection">

<h2>About</h2>

<p id="about"></p>

</section>

<!-- Contact -->
<section class="section" id="contactSection">

<h2>Contact info</h2>

<div class="contact-grid">

<div class="contact-item" id="rowName">
<div class="label">Name</div>
<div class="value" id="contactName"></div>
</div>

<div class="contact-item" id="rowPhone">
<div class="label">Phone</div>
<div class="value"><a id="contactPhone"></a></div>
</div>

<div class="contact-item" id="rowEmail">
<div class="label">Email</div>
<div class="value"><a id="contactEmail"></a></div>
</div>

</div>

<div class="quick-actions" id="quickActions">

<a class="pill" id="pillCall">Call</a>

<a class="pill" id="pillText">Text</a>

<a class="pill" id="pillEmail">Email</a>

</div>

</section>

<footer class="footer">

<span>© <span id="year"></span> <span id="footerBrand"></span></span>

</footer>

</section>

</main>

<script>

const DEFAULT_THEME="/themes/theme-01-neon-dark.css";

const DATA_PATH=(slug)=>`/data/clients/${slug}.json`;

const $=(id)=>document.getElementById(id);

/* ===============================
URL helpers
=============================== */

function normalizeUrl(url){

const u=(url||"").trim();

if(!u)return "";

if(u.startsWith("http"))return u;

return "https://"+u;

}

function setLinkOrHide(id,url){

const el=$(id);

const u=normalizeUrl(url);

if(!u){

el.style.display="none";

return false;

}

el.href=u;

el.style.display="";

return true;

}

function setRawOrHide(id,href){

const el=$(id);

if(!href){

el.style.display="none";

return false;

}

el.href=href;

el.style.display="";

return true;

}

function hide(id){

$(id).style.display="none";

}

function show(id){

$(id).style.display="";

}

/* ===============================
Slug detection
=============================== */

function getSlug(){

const params=new URLSearchParams(location.search);

if(params.get("client"))

return params.get("client").toLowerCase();

const parts=location.pathname.split("/").filter(Boolean);

return parts[0]||"sample";

}

/* ===============================
Load client
=============================== */

async function loadClient(slug){

const res=await fetch(DATA_PATH(slug)+"?v="+Date.now());

if(!res.ok)throw new Error("Client not found");

return await res.json();

}

/* ===============================
Apply client
=============================== */

function setLinkOrHide(id, url) {
  const el = document.getElementById(id);
  if (!el) return;
  const u = (url || "").trim();
  if (!u || u === "#") {
    el.style.display = "none";
    el.removeAttribute("href");
  } else {
    el.style.display = "";
    el.href = u;
  }
}

function applyClient(c){

/* Theme */

const theme=c.theme

? (c.theme.startsWith("/")?c.theme:"/themes/"+c.theme)

:DEFAULT_THEME;

$("themeStylesheet").href=theme+"?v="+Date.now();

/* Title logic */

const business=(c.businessName||"").trim();

const name=(c.contact?.name||"").trim();

const title=business||name||"Contact Card";

document.title=title;

$("brand").textContent=title;

$("footerBrand").textContent=title;

/* Tagline */

if(c.tagline){

$("tagline").textContent=c.tagline;

show("tagline");

}else hide("tagline");

/* About */

if(c.about){

$("about").textContent=c.about;

show("aboutSection");

}else hide("aboutSection");

/* Logo */

$("logoImg").src=c.logoPath||"/logo.jpg";

if(c.links?.website)

$("logoLink").href=normalizeUrl(c.links.website);

else

$("logoLink").removeAttribute("href");

/* Links */

setLinkOrHide("btnWebsite",c.links?.website);

setLinkOrHide("btnFacebook",c.links?.facebook);

setLinkOrHide("btnInstagram",c.links?.instagram);

setLinkOrHide("btnTikTok",c.links?.tiktok);

setRawOrHide("btnVcard",c.vcardPath);

/* Contact */

if(name){

$("contactName").textContent=name;

show("rowName");

}else hide("rowName");

const phone=c.contact?.phoneE164||"";

if(phone){

$("contactPhone").textContent=c.contact?.phoneDisplay||phone;

$("contactPhone").href="tel:"+phone;

show("rowPhone");

}else hide("rowPhone");

const email=c.contact?.email||"";

if(email){

$("contactEmail").textContent=email;

$("contactEmail").href="mailto:"+email;

show("rowEmail");

}else hide("rowEmail");

/* Pills */

const call=setRawOrHide("pillCall",phone?"tel:"+phone:"");

const text=setRawOrHide("pillText",phone?"sms:"+phone:"");

const mail=setRawOrHide("pillEmail",email?"mailto:"+email:"");

if(!call&&!text&&!mail)

hide("quickActions");

}

/* ===============================
Init
=============================== */

async function init(){

$("year").textContent=new Date().getFullYear();

const slug=getSlug();

try{

const client=await loadClient(slug);

applyClient(client);

}catch{

const client=await loadClient("sample");

applyClient(client);

$("brand").textContent="Card not found";

}

}

init();

</script>

</body>
</html>
