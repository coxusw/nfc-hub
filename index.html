<!doctype html>
<!-- =========================================================
  Tap-Deck — Client Profile
  File: /index.html

  Loads client profile from:
  /data/clients/{slug}.json

  Slug is derived from:
  https://tap-deck.com/slug

========================================================= -->
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tap-Deck Profile</title>

  <link rel="stylesheet" id="themeStylesheet" href="">
  <style>
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif;
      background:#0b1020;
      color:#fff;
      display:flex;
      justify-content:center;
      padding:20px;
    }
    .wrap{
      width:min(720px,100%);
      text-align:center;
    }
    .logo{
      max-width:140px;
      margin:0 auto 16px;
    }
    h1{margin:0 0 6px 0}
    .tagline{opacity:.85;margin-bottom:12px}
    .about{opacity:.8;margin-bottom:20px}
    .buttons{
      display:grid;
      grid-template-columns:repeat(2, 1fr);
      gap:10px;
    }
    .btn{
      padding:10px 12px;
      border-radius:12px;
      text-decoration:none;
      font-weight:700;
      background:rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
      color:white;
      display:flex;
      justify-content:center;
      align-items:center;
    }
    .btn.full{
      grid-column:1 / -1;
    }
    .hidden{display:none}
  </style>
</head>

<body>
  <main class="wrap" id="app">
    Loading profile…
  </main>

<script>
/* =========================================================
   CONFIG
========================================================= */
const BRAND_HOST = "tap-deck.com";
/* ========================================================= */

const app = document.getElementById("app");

function getSlugFromPath(){
  const path = window.location.pathname.replace(/^\/+/,"").trim();
  if (!path) return null;
  return path.toLowerCase();
}

function createButton(label, url){
  if (!url) return null;
  const a = document.createElement("a");
  a.href = url;
  a.className = "btn";
  a.target = "_blank";
  a.rel = "noopener";
  a.textContent = label;
  return a;
}

function renderProfile(client){
  document.title = client.businessName || "Tap-Deck Profile";

  // load theme
  if (client.theme){
    document.getElementById("themeStylesheet").href =
      "/themes/" + client.theme;
  }

  app.innerHTML = "";

  // logo
  if (client.logoPath){
    const img = document.createElement("img");
    img.src = client.logoPath;
    img.className = "logo";
    app.appendChild(img);
  }

  // business
  const h1 = document.createElement("h1");
  h1.textContent = client.businessName || "";
  app.appendChild(h1);

  if (client.tagline){
    const t = document.createElement("div");
    t.className = "tagline";
    t.textContent = client.tagline;
    app.appendChild(t);
  }

  if (client.about){
    const a = document.createElement("div");
    a.className = "about";
    a.textContent = client.about;
    app.appendChild(a);
  }

  const grid = document.createElement("div");
  grid.className = "buttons";

  const links = client.links || {};

  const buttons = [
    createButton("Website", links.website),
    createButton("Facebook", links.facebook),
    createButton("Instagram", links.instagram),
    createButton("TikTok", links.tiktok),
    createButton("LinkedIn", links.linkedin),
    createButton("PayPal", links.paypal),
    createButton("Cash App", links.cashapp),
    createButton("Venmo", links.venmo),
  ].filter(Boolean);

  buttons.forEach(btn => grid.appendChild(btn));

  // if odd number, center last
  if (buttons.length % 2 === 1){
    buttons[buttons.length - 1].classList.add("full");
  }

  app.appendChild(grid);
}

async function loadProfile(){
  const slug = getSlugFromPath();

  if (!slug){
    app.innerHTML = "Profile not found.";
    return;
  }

  try{
    const res = await fetch(`/data/clients/${slug}.json`, { cache:"no-store" });
    if (!res.ok) throw new Error("Profile not found");
    const client = await res.json();
    renderProfile(client);
  }catch(err){
    app.innerHTML = "Profile not found.";
  }
}

loadProfile();
</script>
</body>
</html>